#summary ViDaas manual setup instructions

= Introduction =

Documentation work in progress

= Details =

== Fix VMware image wiredness ==

remove `deb cdrom` entry from sources.list
nullmailer

== Runtime setup ==

{{{
apt-get install postgresql mysql-server libmysql-java libpg-java
}}}

Install [JBossBuild]

Currently, there is the possibility of using MySQL and/or PostgreSQL for the underlying database services. To aid with testing (and partly due to historical reasons), MySQL is used on the Controller Node and PostgreSQL is used on the Project Node (for relational database data). Thus, both PostgreSQL and MySql need to be configured. First, create a new PostgreSQL user (sudamihAdmin) and then have it own a new database, sudamihtestdb. Then create a new MySql database (vidaas_v3).

{{{
su postgres
createuser -U postgres -s -E -P sudamihAdmin
#dropuser sudamihAdmin

createdb  -O sudamihAdmin -E UTF8 sudamihtestdb #-U sudamihAdmin

#dropdb sudamihtestdb

mysql -u root -p
mysql> create database vidaas_v3;
#drop database vidaas_v3;

mkdir /opt/VIDaaSData  #to be removed, reported as issue
}}}

== Build vidaas ==
Build requirements

{{{
apt-get install openjdk-6-jdk maven2 subversion
}}}

Build ViDaaS
{{{
svn checkout https://vidaas.googlecode.com/svn/vidaas3/branches/No_XML_DB
cd No_XML_DB/vidaas
vi src/hot/uk/ac/ox/oucs/vidaas/manager/sudamih.properties #update uk.ac.ox.oucs.sudamih.adminUserNamePW reported as issue 44
mvn package
}}}

== Deployment ==

Two files are required for deployment and need to be copied to the $JBOSS_HOME/server/default/deploy directory.
{{{
cp resources/vidaas-ds.xml $JBOSS_HOME/server/default/deploy
cp target/vidaas-0.3.war $JBOSS_HOME/server/default/deploy
}}}
----
Example vidaas3-ds.xml (replace $PASSWORD$ with your mysql password chosen earlier)
{{{
<?xml version="1.0" encoding="UTF-8"?>
<datasources>
   
   <local-tx-datasource>
      <jndi-name>vidaasDatasource</jndi-name>
      <use-java-context>true</use-java-context>
      <connection-url>jdbc:mysql://localhost:3306/vidaas_v3</connection-url>
      <driver-class>com.mysql.jdbc.Driver</driver-class>
      <user-name>root</user-name>
      <password>$PASSWORD$</password>
   </local-tx-datasource>
    
</datasources>
}}}
----

The database drivers need to be installed to JBoss using the following instructions:

{{{
cd $JBOSS_HOME/server/default/lib/
ln -s /usr/share/java/mysql.jar mysql.jar
ln -s /usr/share/java/postgresql.jar postgresql.jar
}}}

JBoss is now ready to be started
{{{
$JBOSS_HOME/bin/run.sh
}}}

Assuming JBoss is using standard configuration, it is now possible to view the Vidaas home page by navigating a browser to
{{{
http://localhost:8080/vidaas-0.3
}}}